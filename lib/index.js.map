{"version":3,"sources":["../src/index.js"],"names":["translationScope","isString","val","Object","prototype","toString","call","isFunction","isPlainObject","isSymbol","key","hasOwnProp","obj","hasOwnProperty","result","getEntry","translations","keys","reduce","_registry","locale","value","previous","emit","fallbackLocales","concat","availableLocales","getAvailableLocales","separator","interpolate","keyTransformer","data","interpolations","options","length","Error","substr","scope","fallbackLocale","_normalizeKeys","entry","fallback","_fallback","includes","ix","fallbackKeys","console","log","join","_pluralize","count","_interpolate","object","type","format","translateIntern","pluralizeFunc","callback","context","setSeparatorIntern","_normalizeKey","normalizedKeys","k","normalizedKeyArray","split","i","splice","keepTrailingDot","values","subject","resolve","dateOrTime","_resolve","test","ii","Counterpart","registerTranslationsIntern","require","setMaxListeners","EventEmitter","instance","onLocaleChange","addLocaleChangeListener","addListener","offLocaleChange","removeLocaleChangeListener","removeListener","onTranslationNotFound","addTranslationNotFoundListener","offTranslationNotFound","removeTranslationNotFoundListener","registerTranslations","translate","setLocale","setLocaleIntern","setFallbackLocale","setFallbackLocaleIntern","setSeparator","Instance","Translator","counterpart"],"mappings":"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","file":"index.js","sourcesContent":["import extend from 'extend';\r\nimport {isArray} from 'util';\r\nimport {isDate} from 'util';\r\nimport {sprintf} from \"sprintf-js\";\r\nimport events from 'events';\r\nimport except from 'except';\r\nimport strftime from './strftime';\r\n\r\nconst translationScope = 'counterpart';\r\n\r\nconst isString = (val) => typeof val === 'string' || Object.prototype.toString.call(val) === '[object String]';\r\n\r\nconst isFunction = (val) => typeof val === 'function' || Object.prototype.toString.call(val) === '[object Function]';\r\n\r\nconst isPlainObject = (val) => {\r\n  //Deal with older browsers (IE8) that don't return [object Null] in this case.\r\n  if (val === null) {\r\n    return false;\r\n  }\r\n  return Object.prototype.toString.call(val) === '[object Object]';\r\n}\r\n\r\nconst isSymbol = (key) => isString(key) && key[0] === ':';\r\n\r\nconst hasOwnProp = (obj, key) => Object.prototype.hasOwnProperty.call(obj, key);\r\n\r\nconst getEntry = (translations, keys) => keys.reduce((result, key) => {\r\n                                            if (isPlainObject(result) && hasOwnProp(result, key)) {\r\n                                              return result[key];\r\n                                            } else {\r\n                                              return null;\r\n                                            }\r\n                                          }, translations);\r\n\r\nclass Counterpart extends events.EventEmitter {\r\n  constructor() {\r\n    super();\r\n    this._registry = {\r\n      locale: 'en',\r\n      interpolate: true,\r\n      fallbackLocales: [],\r\n      scope: null,\r\n      translations: {},\r\n      interpolations: {},\r\n      normalizedKeys: {},\r\n      separator: '.',\r\n      keepTrailingDot: false,\r\n      keyTransformer(key) { return key; }\r\n    };\r\n\r\n    this.registerTranslationsIntern('en', require('../locales/en'));\r\n    this.setMaxListeners(0);\r\n  }\r\n\r\n  getLocale() {\r\n    return this._registry.locale;\r\n  }\r\n\r\n  setLocaleIntern(value) {\r\n    const previous = this._registry.locale;\r\n\r\n    if (previous != value) {\r\n      this._registry.locale = value;\r\n      this.emit('localechange', value, previous);\r\n    }\r\n\r\n    return previous;\r\n  }\r\n\r\n  getFallbackLocale() {\r\n    return this._registry.fallbackLocales;\r\n  }\r\n\r\n  setFallbackLocaleIntern(value) {\r\n    const previous = this._registry.fallbackLocales;\r\n    this._registry.fallbackLocales = [].concat(value || []);\r\n    return previous;\r\n  }\r\n\r\n  getAvailableLocales() {\r\n    return this._registry.availableLocales || Object.keys(this._registry.translations);\r\n  }\r\n\r\n  setAvailableLocales(value) {\r\n    const previous = this.getAvailableLocales();\r\n    this._registry.availableLocales = value;\r\n    return previous;\r\n  }\r\n\r\n  getSeparator() {\r\n    return this._registry.separator;\r\n  }\r\n\r\n  setSeparatorIntern(value) {\r\n    const previous = this._registry.separator;\r\n    this._registry.separator = value;\r\n    return previous;\r\n  }\r\n\r\n  setInterpolate(value) {\r\n    const previous = this._registry.interpolate;\r\n    this._registry.interpolate = value;\r\n    return previous;\r\n  }\r\n\r\n  getInterpolate() {\r\n    return this._registry.interpolate;\r\n  }\r\n\r\n  setKeyTransformer(value) {\r\n    const previous = this._registry.keyTransformer;\r\n    this._registry.keyTransformer = value;\r\n    return previous;\r\n  }\r\n\r\n  getKeyTransformer() {\r\n    return this._registry.keyTransformer;\r\n  }\r\n\r\n  registerTranslationsIntern(locale, data) {\r\n    const translations = {};\r\n    translations[locale] = data;\r\n    extend(true, this._registry.translations, translations);\r\n    return translations;\r\n  }\r\n\r\n  registerInterpolations(data) {\r\n    return extend(true, this._registry.interpolations, data);\r\n  }\r\n\r\n  translateIntern(key, options) {\r\n    if (!isArray(key) && !isString(key) || !key.length) {\r\n      throw new Error('invalid argument: key');\r\n    }\r\n\r\n    if (isSymbol(key)) {\r\n      key = key.substr(1);\r\n    }\r\n\r\n    key = this._registry.keyTransformer(key, options);\r\n\r\n    options = extend(true, {}, options);\r\n\r\n    let locale = options.locale || this._registry.locale;\r\n    delete options.locale;\r\n\r\n    const scope = options.scope || this._registry.scope;\r\n    delete options.scope;\r\n\r\n    const separator = options.separator || this._registry.separator;\r\n    delete options.separator;\r\n\r\n    const fallbackLocales = [].concat(options.fallbackLocale || this._registry.fallbackLocales);\r\n    delete options.fallbackLocale;\r\n\r\n    const keys = this._normalizeKeys(locale, scope, key, separator);\r\n\r\n    let entry = getEntry(this._registry.translations, keys);\r\n\r\n    if (entry === null && options.fallback) {\r\n      this.emit('translationnotfound', locale, key, options.fallback, scope);\r\n      entry = this._fallback(locale, scope, key, options.fallback, options);\r\n    }\r\n\r\n    if (entry === null && fallbackLocales.length > 0 && !fallbackLocales.includes(locale)) {\r\n      for (const ix in fallbackLocales) {\r\n        const fallbackLocale = fallbackLocales[ix];\r\n        const fallbackKeys = this._normalizeKeys(fallbackLocale, scope, key, separator);\r\n        entry = getEntry(this._registry.translations, fallbackKeys);\r\n\r\n        if (entry) {\r\n          locale = fallbackLocale;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    if (entry === null) {\r\n      entry = keys[1];\r\n      console.log('counterpart missing translation: ' + keys.join(separator));\r\n    }\r\n\r\n    entry = this._pluralize(locale, entry, options.count);\r\n\r\n    if (this._registry.interpolate !== false && options.interpolate !== false) {\r\n      entry = this._interpolate(entry, options);\r\n    }\r\n\r\n    return entry;\r\n  }\r\n\r\n  localize(object, options) {\r\n    if (!isDate(object)) {\r\n      throw new Error('invalid argument: object must be a date');\r\n    }\r\n\r\n    options = extend(true, {}, options);\r\n\r\n    const locale  = options.locale  || this._registry.locale;\r\n    const scope   = options.scope   || translationScope;\r\n    const type    = options.type    || 'datetime';\r\n    let format  = options.format  || 'default';\r\n\r\n    options = { locale, scope, interpolate: false };\r\n    format  = this.translateIntern(['formats', type, format], extend(true, {}, options));\r\n\r\n    return strftime(object, format, this.translateIntern('names', options));\r\n  }\r\n\r\n  _pluralize(locale, entry, count) {\r\n    if (typeof entry !== 'object' || entry === null || typeof count !== 'number') {\r\n      return entry;\r\n    }\r\n\r\n    const pluralizeFunc = this.translateIntern('pluralize', { locale, scope: translationScope });\r\n\r\n    if (Object.prototype.toString.call(pluralizeFunc) !== '[object Function]') {\r\n      return pluralizeFunc;\r\n    }\r\n\r\n    return pluralizeFunc(entry, count);\r\n  }\r\n\r\n  withLocale(locale, callback, context) {\r\n    const previous = this._registry.locale;\r\n    this._registry.locale = locale;\r\n    const result = callback.call(context);\r\n    this._registry.locale = previous;\r\n    return result;\r\n  }\r\n\r\n  withScope(scope, callback, context) {\r\n    const previous = this._registry.scope;\r\n    this._registry.scope = scope;\r\n    const result = callback.call(context);\r\n    this._registry.scope = previous;\r\n    return result;\r\n  }\r\n\r\n  withSeparator(separator, callback, context) {\r\n    const previous = this.setSeparatorIntern(separator);\r\n    const result = callback.call(context);\r\n    this.setSeparatorIntern(previous);\r\n    return result;\r\n  }\r\n\r\n  _normalizeKeys(locale, scope, key, separator) {\r\n    let keys = [];\r\n\r\n    keys = keys.concat(this._normalizeKey(locale, separator));\r\n    keys = keys.concat(this._normalizeKey(scope, separator));\r\n    keys = keys.concat(this._normalizeKey(key, separator));\r\n\r\n    return keys;\r\n  }\r\n\r\n  _normalizeKey(key, separator) {\r\n    this._registry.normalizedKeys[separator] = this._registry.normalizedKeys[separator] || {};\r\n\r\n    this._registry.normalizedKeys[separator][key] = this._registry.normalizedKeys[separator][key] || ((key => {\r\n      if (isArray(key)) {\r\n        const normalizedKeyArray = key.map(k => this._normalizeKey(k, separator));\r\n\r\n        return [].concat(...normalizedKeyArray);\r\n      } else {\r\n        if (typeof key === 'undefined' || key === null) {\r\n          return [];\r\n        }\r\n\r\n        const keys = key.split(separator);\r\n\r\n        for (let i = keys.length - 1; i >= 0; i--) {\r\n          if (keys[i] === '') {\r\n            keys.splice(i, 1);\r\n\r\n            if (this._registry.keepTrailingDot === true && i == keys.length) {\r\n              keys[keys.length - 1] += `${separator}`;\r\n            }\r\n          }\r\n        }\r\n\r\n        return keys;\r\n      }\r\n    }))(key);\r\n\r\n    return this._registry.normalizedKeys[separator][key];\r\n  }\r\n\r\n  _interpolate(entry, values) {\r\n    if (typeof entry !== 'string') {\r\n      return entry;\r\n    }\r\n\r\n    return sprintf(entry, extend({}, this._registry.interpolations, values));\r\n  }\r\n\r\n  _resolve(locale, scope, object, subject, options={}) {\r\n    if (options.resolve === false) {\r\n      return subject;\r\n    }\r\n\r\n    let result;\r\n\r\n    if (isSymbol(subject)) {\r\n      result = this.translateIntern(subject, extend({}, options, { locale, scope }));\r\n    } else if (isFunction(subject)) {\r\n      let dateOrTime;\r\n\r\n      if (options.object) {\r\n        dateOrTime = options.object;\r\n        delete options.object;\r\n      } else {\r\n        dateOrTime = object;\r\n      }\r\n\r\n      result = this._resolve(locale, scope, object, subject(dateOrTime, options));\r\n    } else {\r\n      result = subject;\r\n    }\r\n\r\n    return /^missing translation:/.test(result) ? null : result;\r\n  }\r\n\r\n  _fallback(locale, scope, object, subject, options) {\r\n    options = except(options, 'fallback');\r\n\r\n    if (isArray(subject)) {\r\n      for (let i = 0, ii = subject.length; i < ii; i++) {\r\n        const result = this._resolve(locale, scope, object, subject[i], options);\r\n\r\n        if (result) {\r\n          return result;\r\n        }\r\n      }\r\n\r\n      return null;\r\n    } else {\r\n      return this._resolve(locale, scope, object, subject, options);\r\n    }\r\n  }\r\n}\r\n\r\nconst instance = new Counterpart();\r\n\r\nCounterpart.prototype.onLocaleChange =\r\nCounterpart.prototype.addLocaleChangeListener = (callback) => {\r\n                                                  events.EventEmitter.addListener('localechange', callback);\r\n                                                };\r\n\r\nCounterpart.prototype.offLocaleChange =\r\nCounterpart.prototype.removeLocaleChangeListener = (callback) => {\r\n                                                      events.EventEmitter.removeListener('localechange', callback);\r\n                                                    };\r\n\r\nCounterpart.prototype.onTranslationNotFound =\r\nCounterpart.prototype.addTranslationNotFoundListener = (callback) => {\r\n                                                          events.EventEmitter.addListener('translationnotfound', callback);\r\n                                                        };\r\n\r\nCounterpart.prototype.offTranslationNotFound =\r\nCounterpart.prototype.removeTranslationNotFoundListener = (callback) => {\r\n                                                            events.EventEmitter.removeListener('translationnotfound', callback);\r\n                                                          };\r\nconst registerTranslations = (locale, data) => instance.registerTranslationsIntern(locale, data);\r\nconst translate = (key, options) => instance.translateIntern(key, options);\r\nconst setLocale = (value) => instance.setLocaleIntern(value);\r\nconst setFallbackLocale  = (value) => instance.setFallbackLocaleIntern(value);\r\nconst setSeparator = (value) => instance.setSeparatorIntern(value);\r\n\r\nextend(translate, instance, {\r\n  Instance: Counterpart,\r\n  Translator: Counterpart\r\n});\r\n\r\nexport default translate\r\nconst counterpart = new Counterpart;\r\nexport {counterpart, translate, registerTranslations, setLocale, setFallbackLocale}\r\n"]}