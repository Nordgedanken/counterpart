{"version":3,"sources":["../src/index.js"],"names":["translationScope","isString","val","Object","prototype","toString","call","isFunction","isPlainObject","isSymbol","key","hasOwnProp","obj","hasOwnProperty","result","getEntry","translations","keys","reduce","_registry","locale","value","previous","EventEmitter","emit","fallbackLocales","concat","availableLocales","getAvailableLocales","separator","interpolate","keyTransformer","data","interpolations","options","length","Error","substr","scope","fallbackLocale","_normalizeKeys","entry","fallback","_fallback","includes","ix","fallbackKeys","join","_pluralize","count","_interpolate","object","type","format","translateIntern","pluralizeFunc","callback","context","setSeparatorIntern","_normalizeKey","normalizedKeys","k","normalizedKeyArray","split","i","splice","keepTrailingDot","values","subject","resolve","dateOrTime","_resolve","test","ii","Counterpart","registerTranslationsIntern","require","setMaxListeners","instance","onLocaleChange","addLocaleChangeListener","addListener","offLocaleChange","removeLocaleChangeListener","removeListener","onTranslationNotFound","addTranslationNotFoundListener","offTranslationNotFound","removeTranslationNotFoundListener","registerTranslations","translate","setLocale","setLocaleIntern","setFallbackLocale","setFallbackLocaleIntern","setSeparator","Instance","Translator","counterpart"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AACA;;AAEA;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,IAAMA,mBAAmB,aAAzB;;AAEA,IAAMC,WAAW,SAAXA,QAAW,CAACC,GAAD;AAAA,SAAS,OAAOA,GAAP,KAAe,QAAf,IAA2BC,OAAOC,SAAP,CAAiBC,QAAjB,CAA0BC,IAA1B,CAA+BJ,GAA/B,MAAwC,iBAA5E;AAAA,CAAjB;;AAEA,IAAMK,aAAa,SAAbA,UAAa,CAACL,GAAD;AAAA,SAAS,OAAOA,GAAP,KAAe,UAAf,IAA6BC,OAAOC,SAAP,CAAiBC,QAAjB,CAA0BC,IAA1B,CAA+BJ,GAA/B,MAAwC,mBAA9E;AAAA,CAAnB;;AAEA,IAAMM,gBAAgB,SAAhBA,aAAgB,CAACN,GAAD,EAAS;AAC7B;AACA,MAAIA,QAAQ,IAAZ,EAAkB;AAChB,WAAO,KAAP;AACD;AACD,SAAOC,OAAOC,SAAP,CAAiBC,QAAjB,CAA0BC,IAA1B,CAA+BJ,GAA/B,MAAwC,iBAA/C;AACD,CAND;;AAQA,IAAMO,WAAW,SAAXA,QAAW,CAACC,GAAD;AAAA,SAAST,SAASS,GAAT,KAAiBA,IAAI,CAAJ,MAAW,GAArC;AAAA,CAAjB;;AAEA,IAAMC,aAAa,SAAbA,UAAa,CAACC,GAAD,EAAMF,GAAN;AAAA,SAAcP,OAAOC,SAAP,CAAiBS,cAAjB,CAAgCP,IAAhC,CAAqCM,GAArC,EAA0CF,GAA1C,CAAd;AAAA,CAAnB;;AAEqD,cAACI,MAAD,EAASJ,GAAT,EAAiB;AAC1B,MAAIF,cAAcM,MAAd,KAAyBH,WAAWG,MAAX,EAAmBJ,GAAnB,CAA7B,EAAsD;AACpD,WAAOI,OAAOJ,GAAP,CAAP;AACD,GAFD,MAEO;AACL,WAAO,IAAP;AACD;AACF;;AAN3C,IAAMK,WAAW,SAAXA,QAAW,CAACC,YAAD,EAAeC,IAAf;AAAA,SAAwBA,KAAKC,MAAL,OAMIF,YANJ,CAAxB;AAAA,CAAjB;;yBAoBqBN,G,EAAK;AAAE,SAAOA,GAAP;AAAa;;sBAO3B;AACV,SAAO,KAAKS,SAAL,CAAeC,MAAtB;AACD;;0BAEeC,K,EAAO;AACrB,MAAMC,WAAW,KAAKH,SAAL,CAAeC,MAAhC;;AAEA,MAAIE,YAAYD,KAAhB,EAAuB;AACrB,SAAKF,SAAL,CAAeC,MAAf,GAAwBC,KAAxB;AACA,qBAAOE,YAAP,CAAoBC,IAApB,CAAyB,cAAzB,EAAyCH,KAAzC,EAAgDC,QAAhD;AACD;;AAED,SAAOA,QAAP;AACD;;8BAEmB;AAClB,SAAO,KAAKH,SAAL,CAAeM,eAAtB;AACD;;+BAEuBJ,K,EAAO;AAC7B,MAAMC,WAAW,KAAKH,SAAL,CAAeM,eAAhC;AACA,OAAKN,SAAL,CAAeM,eAAf,GAAiC,GAAGC,MAAH,CAAUL,SAAS,EAAnB,CAAjC;AACA,SAAOC,QAAP;AACD;;gCAEqB;AACpB,SAAO,KAAKH,SAAL,CAAeQ,gBAAf,IAAmC,oBAAY,KAAKR,SAAL,CAAeH,YAA3B,CAA1C;AACD;;8BAEmBK,K,EAAO;AACzB,MAAMC,WAAW,KAAKM,mBAAL,EAAjB;AACA,OAAKT,SAAL,CAAeQ,gBAAf,GAAkCN,KAAlC;AACA,SAAOC,QAAP;AACD;;yBAEc;AACb,SAAO,KAAKH,SAAL,CAAeU,SAAtB;AACD;;6BAEkBR,K,EAAO;AACxB,MAAMC,WAAW,KAAKH,SAAL,CAAeU,SAAhC;AACA,OAAKV,SAAL,CAAeU,SAAf,GAA2BR,KAA3B;AACA,SAAOC,QAAP;AACD;;yBAEcD,K,EAAO;AACpB,MAAMC,WAAW,KAAKH,SAAL,CAAeW,WAAhC;AACA,OAAKX,SAAL,CAAeW,WAAf,GAA6BT,KAA7B;AACA,SAAOC,QAAP;AACD;;2BAEgB;AACf,SAAO,KAAKH,SAAL,CAAeW,WAAtB;AACD;;4BAEiBT,K,EAAO;AACvB,MAAMC,WAAW,KAAKH,SAAL,CAAeY,cAAhC;AACA,OAAKZ,SAAL,CAAeY,cAAf,GAAgCV,KAAhC;AACA,SAAOC,QAAP;AACD;;8BAEmB;AAClB,SAAO,KAAKH,SAAL,CAAeY,cAAtB;AACD;;+BAE0BX,M,EAAQY,I,EAAM;AACvC,MAAMhB,eAAe,EAArB;AACAA,eAAaI,MAAb,IAAuBY,IAAvB;AACA,wBAAO,IAAP,EAAa,KAAKb,SAAL,CAAeH,YAA5B,EAA0CA,YAA1C;AACA,SAAOA,YAAP;AACD;;+BAEsBgB,I,EAAM;AAC3B,SAAO,sBAAO,IAAP,EAAa,KAAKb,SAAL,CAAec,cAA5B,EAA4CD,IAA5C,CAAP;AACD;;0BAEetB,G,EAAKwB,O,EAAS;AAC5B,MAAI,CAAC,mBAAQxB,GAAR,CAAD,IAAiB,CAACT,SAASS,GAAT,CAAlB,IAAmC,CAACA,IAAIyB,MAA5C,EAAoD;AAClD,UAAM,IAAIC,KAAJ,CAAU,uBAAV,CAAN;AACD;;AAED,MAAI3B,SAASC,GAAT,CAAJ,EAAmB;AACjBA,UAAMA,IAAI2B,MAAJ,CAAW,CAAX,CAAN;AACD;;AAED3B,QAAM,KAAKS,SAAL,CAAeY,cAAf,CAA8BrB,GAA9B,EAAmCwB,OAAnC,CAAN;;AAEAA,YAAU,sBAAO,IAAP,EAAa,EAAb,EAAiBA,OAAjB,CAAV;;AAEA,MAAId,SAASc,QAAQd,MAAR,IAAkB,KAAKD,SAAL,CAAeC,MAA9C;AACA,SAAOc,QAAQd,MAAf;;AAEA,MAAMkB,QAAQJ,QAAQI,KAAR,IAAiB,KAAKnB,SAAL,CAAemB,KAA9C;AACA,SAAOJ,QAAQI,KAAf;;AAEA,MAAMT,YAAYK,QAAQL,SAAR,IAAqB,KAAKV,SAAL,CAAeU,SAAtD;AACA,SAAOK,QAAQL,SAAf;;AAEA,MAAMJ,kBAAkB,GAAGC,MAAH,CAAUQ,QAAQK,cAAR,IAA0B,KAAKpB,SAAL,CAAeM,eAAnD,CAAxB;AACA,SAAOS,QAAQK,cAAf;;AAEA,MAAMtB,OAAO,KAAKuB,cAAL,CAAoBpB,MAApB,EAA4BkB,KAA5B,EAAmC5B,GAAnC,EAAwCmB,SAAxC,CAAb;;AAEA,MAAIY,QAAQ1B,SAAS,KAAKI,SAAL,CAAeH,YAAxB,EAAsCC,IAAtC,CAAZ;;AAEA,MAAIwB,UAAU,IAAV,IAAkBP,QAAQQ,QAA9B,EAAwC;AACtC,qBAAOnB,YAAP,CAAoBC,IAApB,CAAyB,qBAAzB,EAAgDJ,MAAhD,EAAwDV,GAAxD,EAA6DwB,QAAQQ,QAArE,EAA+EJ,KAA/E;AACAG,YAAQ,KAAKE,SAAL,CAAevB,MAAf,EAAuBkB,KAAvB,EAA8B5B,GAA9B,EAAmCwB,QAAQQ,QAA3C,EAAqDR,OAArD,CAAR;AACD;;AAED,MAAIO,UAAU,IAAV,IAAkBhB,gBAAgBU,MAAhB,GAAyB,CAA3C,IAAgD,CAACV,gBAAgBmB,QAAhB,CAAyBxB,MAAzB,CAArD,EAAuF;AACrF,SAAK,IAAMyB,EAAX,IAAiBpB,eAAjB,EAAkC;AAChC,UAAMc,iBAAiBd,gBAAgBoB,EAAhB,CAAvB;AACA,UAAMC,eAAe,KAAKN,cAAL,CAAoBD,cAApB,EAAoCD,KAApC,EAA2C5B,GAA3C,EAAgDmB,SAAhD,CAArB;AACAY,cAAQ1B,SAAS,KAAKI,SAAL,CAAeH,YAAxB,EAAsC8B,YAAtC,CAAR;;AAEA,UAAIL,KAAJ,EAAW;AACTrB,iBAASmB,cAAT;AACA;AACD;AACF;AACF;;AAED,MAAIE,UAAU,IAAd,EAAoB;AAClBA,sCAAgCxB,KAAK8B,IAAL,CAAUlB,SAAV,CAAhC;AACD;;AAEDY,UAAQ,KAAKO,UAAL,CAAgB5B,MAAhB,EAAwBqB,KAAxB,EAA+BP,QAAQe,KAAvC,CAAR;;AAEA,MAAI,KAAK9B,SAAL,CAAeW,WAAf,KAA+B,KAA/B,IAAwCI,QAAQJ,WAAR,KAAwB,KAApE,EAA2E;AACzEW,YAAQ,KAAKS,YAAL,CAAkBT,KAAlB,EAAyBP,OAAzB,CAAR;AACD;;AAED,SAAOO,KAAP;AACD;;mBAEQU,M,EAAQjB,O,EAAS;AACxB,MAAI,CAAC,kBAAOiB,MAAP,CAAL,EAAqB;AACnB,UAAM,IAAIf,KAAJ,CAAU,yCAAV,CAAN;AACD;;AAEDF,YAAU,sBAAO,IAAP,EAAa,EAAb,EAAiBA,OAAjB,CAAV;;AAEA,MAAMd,SAAUc,QAAQd,MAAR,IAAmB,KAAKD,SAAL,CAAeC,MAAlD;AACA,MAAMkB,QAAUJ,QAAQI,KAAR,IAAmBtC,gBAAnC;AACA,MAAMoD,OAAUlB,QAAQkB,IAAR,IAAmB,UAAnC;AACA,MAAIC,SAAUnB,QAAQmB,MAAR,IAAmB,SAAjC;;AAEAnB,YAAU,EAAEd,cAAF,EAAUkB,YAAV,EAAiBR,aAAa,KAA9B,EAAV;AACAuB,WAAU,KAAKC,eAAL,CAAqB,CAAC,SAAD,EAAYF,IAAZ,EAAkBC,MAAlB,CAArB,EAAgD,sBAAO,IAAP,EAAa,EAAb,EAAiBnB,OAAjB,CAAhD,CAAV;;AAEA,SAAO,wBAASiB,MAAT,EAAiBE,MAAjB,EAAyB,KAAKC,eAAL,CAAqB,OAArB,EAA8BpB,OAA9B,CAAzB,CAAP;AACD;;qBAEUd,M,EAAQqB,K,EAAOQ,K,EAAO;AAC/B,MAAI,QAAOR,KAAP,uDAAOA,KAAP,OAAiB,QAAjB,IAA6BA,UAAU,IAAvC,IAA+C,OAAOQ,KAAP,KAAiB,QAApE,EAA8E;AAC5E,WAAOR,KAAP;AACD;;AAED,MAAMc,gBAAgB,KAAKD,eAAL,CAAqB,WAArB,EAAkC,EAAElC,cAAF,EAAUkB,OAAOtC,gBAAjB,EAAlC,CAAtB;;AAEA,MAAIG,OAAOC,SAAP,CAAiBC,QAAjB,CAA0BC,IAA1B,CAA+BiD,aAA/B,MAAkD,mBAAtD,EAA2E;AACzE,WAAOA,aAAP;AACD;;AAED,SAAOA,cAAcd,KAAd,EAAqBQ,KAArB,CAAP;AACD;;qBAEU7B,M,EAAQoC,Q,EAAUC,O,EAAS;AACpC,MAAMnC,WAAW,KAAKH,SAAL,CAAeC,MAAhC;AACA,OAAKD,SAAL,CAAeC,MAAf,GAAwBA,MAAxB;AACA,MAAMN,SAAS0C,SAASlD,IAAT,CAAcmD,OAAd,CAAf;AACA,OAAKtC,SAAL,CAAeC,MAAf,GAAwBE,QAAxB;AACA,SAAOR,MAAP;AACD;;oBAESwB,K,EAAOkB,Q,EAAUC,O,EAAS;AAClC,MAAMnC,WAAW,KAAKH,SAAL,CAAemB,KAAhC;AACA,OAAKnB,SAAL,CAAemB,KAAf,GAAuBA,KAAvB;AACA,MAAMxB,SAAS0C,SAASlD,IAAT,CAAcmD,OAAd,CAAf;AACA,OAAKtC,SAAL,CAAemB,KAAf,GAAuBhB,QAAvB;AACA,SAAOR,MAAP;AACD;;wBAEae,S,EAAW2B,Q,EAAUC,O,EAAS;AAC1C,MAAMnC,WAAW,KAAKoC,kBAAL,CAAwB7B,SAAxB,CAAjB;AACA,MAAMf,SAAS0C,SAASlD,IAAT,CAAcmD,OAAd,CAAf;AACA,OAAKC,kBAAL,CAAwBpC,QAAxB;AACA,SAAOR,MAAP;AACD;;yBAEcM,M,EAAQkB,K,EAAO5B,G,EAAKmB,S,EAAW;AAC5C,MAAIZ,OAAO,EAAX;;AAEAA,SAAOA,KAAKS,MAAL,CAAY,KAAKiC,aAAL,CAAmBvC,MAAnB,EAA2BS,SAA3B,CAAZ,CAAP;AACAZ,SAAOA,KAAKS,MAAL,CAAY,KAAKiC,aAAL,CAAmBrB,KAAnB,EAA0BT,SAA1B,CAAZ,CAAP;AACAZ,SAAOA,KAAKS,MAAL,CAAY,KAAKiC,aAAL,CAAmBjD,GAAnB,EAAwBmB,SAAxB,CAAZ,CAAP;;AAEA,SAAOZ,IAAP;AACD;;wBAEaP,G,EAAKmB,S,EAAW;AAAA;;AAC5B,OAAKV,SAAL,CAAeyC,cAAf,CAA8B/B,SAA9B,IAA2C,KAAKV,SAAL,CAAeyC,cAAf,CAA8B/B,SAA9B,KAA4C,EAAvF;;AAEA,OAAKV,SAAL,CAAeyC,cAAf,CAA8B/B,SAA9B,EAAyCnB,GAAzC,IAAgD,KAAKS,SAAL,CAAeyC,cAAf,CAA8B/B,SAA9B,EAAyCnB,GAAzC,KAAmD,eAAO;AACxG,QAAI,mBAAQA,GAAR,CAAJ,EAAkB;AAAA;;AAAA,eACWA,GADX;;AAAA,eACmB;AAAA,eAAK,MAAKiD,aAAL,CAAmBE,CAAnB,EAAsBhC,SAAtB,CAAL;AAAA,OADnB;;AAAA;;AAAA;AAAA;AAAA;;AAChB,UAAMiC,uBAAN;;AAEA,aAAO,aAAGpC,MAAH,+CAAaoC,kBAAb,EAAP;AACD,KAJD,MAIO;AACL,UAAI,OAAOpD,GAAP,KAAe,WAAf,IAA8BA,QAAQ,IAA1C,EAAgD;AAC9C,eAAO,EAAP;AACD;;AAED,UAAMO,OAAOP,IAAIqD,KAAJ,CAAUlC,SAAV,CAAb;;AAEA,WAAK,IAAImC,IAAI/C,KAAKkB,MAAL,GAAc,CAA3B,EAA8B6B,KAAK,CAAnC,EAAsCA,GAAtC,EAA2C;AACzC,YAAI/C,KAAK+C,CAAL,MAAY,EAAhB,EAAoB;AAClB/C,eAAKgD,MAAL,CAAYD,CAAZ,EAAe,CAAf;;AAEA,cAAI,MAAK7C,SAAL,CAAe+C,eAAf,KAAmC,IAAnC,IAA2CF,KAAK/C,KAAKkB,MAAzD,EAAiE;AAC/DlB,iBAAKA,KAAKkB,MAAL,GAAc,CAAnB,UAA4BN,SAA5B;AACD;AACF;AACF;;AAED,aAAOZ,IAAP;AACD;AACF,GAxBgG,CAwB7FP,GAxB6F,CAAjG;;AA0BA,SAAO,KAAKS,SAAL,CAAeyC,cAAf,CAA8B/B,SAA9B,EAAyCnB,GAAzC,CAAP;AACD;;uBAEY+B,K,EAAO0B,M,EAAQ;AAC1B,MAAI,OAAO1B,KAAP,KAAiB,QAArB,EAA+B;AAC7B,WAAOA,KAAP;AACD;;AAED,SAAO,wBAAQA,KAAR,EAAe,sBAAO,EAAP,EAAW,KAAKtB,SAAL,CAAec,cAA1B,EAA0CkC,MAA1C,CAAf,CAAP;AACD;;mBAEQ/C,M,EAAQkB,K,EAAOa,M,EAAQiB,O,EAAqB;AAAA,MAAZlC,OAAY,uEAAJ,EAAI;;AACnD,MAAIA,QAAQmC,OAAR,KAAoB,KAAxB,EAA+B;AAC7B,WAAOD,OAAP;AACD;;AAED,MAAItD,eAAJ;;AAEA,MAAIL,SAAS2D,OAAT,CAAJ,EAAuB;AACrBtD,aAAS,KAAKwC,eAAL,CAAqBc,OAArB,EAA8B,sBAAO,EAAP,EAAWlC,OAAX,EAAoB,EAAEd,cAAF,EAAUkB,YAAV,EAApB,CAA9B,CAAT;AACD,GAFD,MAEO,IAAI/B,WAAW6D,OAAX,CAAJ,EAAyB;AAC9B,QAAIE,mBAAJ;;AAEA,QAAIpC,QAAQiB,MAAZ,EAAoB;AAClBmB,mBAAapC,QAAQiB,MAArB;AACA,aAAOjB,QAAQiB,MAAf;AACD,KAHD,MAGO;AACLmB,mBAAanB,MAAb;AACD;;AAEDrC,aAAS,KAAKyD,QAAL,CAAcnD,MAAd,EAAsBkB,KAAtB,EAA6Ba,MAA7B,EAAqCiB,QAAQE,UAAR,EAAoBpC,OAApB,CAArC,CAAT;AACD,GAXM,MAWA;AACLpB,aAASsD,OAAT;AACD;;AAED,SAAO,yBAAwBI,IAAxB,CAA6B1D,MAA7B,IAAuC,IAAvC,GAA8CA;AAArD;AACD;;oBAESM,M,EAAQkB,K,EAAOa,M,EAAQiB,O,EAASlC,O,EAAS;AACjDA,YAAU,sBAAOA,OAAP,EAAgB,UAAhB,CAAV;;AAEA,MAAI,mBAAQkC,OAAR,CAAJ,EAAsB;AACpB,SAAK,IAAIJ,IAAI,CAAR,EAAWS,KAAKL,QAAQjC,MAA7B,EAAqC6B,IAAIS,EAAzC,EAA6CT,GAA7C,EAAkD;AAChD,UAAMlD,SAAS,KAAKyD,QAAL,CAAcnD,MAAd,EAAsBkB,KAAtB,EAA6Ba,MAA7B,EAAqCiB,QAAQJ,CAAR,CAArC,EAAiD9B,OAAjD,CAAf;;AAEA,UAAIpB,MAAJ,EAAY;AACV,eAAOA,MAAP;AACD;AACF;;AAED,WAAO,IAAP;AACD,GAVD,MAUO;AACL,WAAO,KAAKyD,QAAL,CAAcnD,MAAd,EAAsBkB,KAAtB,EAA6Ba,MAA7B,EAAqCiB,OAArC,EAA8ClC,OAA9C,CAAP;AACD;AACF;;IA/SGwC,W;AACJ,yBAAc;AAAA;;AACZ,SAAKvD,SAAL,GAAiB;AACfC,cAAQ,IADO;AAEfU,mBAAa,IAFE;AAGfL,uBAAiB,EAHF;AAIfa,aAAO,IAJQ;AAKftB,oBAAc,EALC;AAMfiB,sBAAgB,EAND;AAOf2B,sBAAgB,EAPD;AAQf/B,iBAAW,GARI;AASfqC,uBAAiB,KATF;AAUfnC,oBAVe;AAAA,KAAjB;;AAaA,SAAK4C,0BAAL,CAAgC,IAAhC,EAAsCC,QAAQ,eAAR,CAAtC;AACA,SAAKC,eAAL,CAAqB,CAArB;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiSH,IAAMC,WAAW,IAAIJ,WAAJ,EAAjB;;AAEAA,YAAYtE,SAAZ,CAAsB2E,cAAtB,GACAL,YAAYtE,SAAZ,CAAsB4E,uBAAtB,GAAgD,UAACxB,QAAD,EAAc;AACZ,mBAAOjC,YAAP,CAAoB0D,WAApB,CAAgC,cAAhC,EAAgDzB,QAAhD;AACD,CAHjD;;AAKAkB,YAAYtE,SAAZ,CAAsB8E,eAAtB,GACAR,YAAYtE,SAAZ,CAAsB+E,0BAAtB,GAAmD,UAAC3B,QAAD,EAAc;AACX,mBAAOjC,YAAP,CAAoB6D,cAApB,CAAmC,cAAnC,EAAmD5B,QAAnD;AACD,CAHrD;;AAKAkB,YAAYtE,SAAZ,CAAsBiF,qBAAtB,GACAX,YAAYtE,SAAZ,CAAsBkF,8BAAtB,GAAuD,UAAC9B,QAAD,EAAc;AACX,mBAAOjC,YAAP,CAAoB0D,WAApB,CAAgC,qBAAhC,EAAuDzB,QAAvD;AACD,CAHzD;;AAKAkB,YAAYtE,SAAZ,CAAsBmF,sBAAtB,GACAb,YAAYtE,SAAZ,CAAsBoF,iCAAtB,GAA0D,UAAChC,QAAD,EAAc;AACZ,mBAAOjC,YAAP,CAAoB6D,cAApB,CAAmC,qBAAnC,EAA0D5B,QAA1D;AACD,CAH3D;AAIA,IAAMiC,uBAAuB,SAAvBA,oBAAuB,CAACrE,MAAD,EAASY,IAAT;AAAA,SAAkB8C,SAASH,0BAAT,CAAoCvD,MAApC,EAA4CY,IAA5C,CAAlB;AAAA,CAA7B;AACA,IAAM0D,YAAY,SAAZA,SAAY,CAAChF,GAAD,EAAMwB,OAAN;AAAA,SAAkB4C,SAASxB,eAAT,CAAyB5C,GAAzB,EAA8BwB,OAA9B,CAAlB;AAAA,CAAlB;AACA,IAAMyD,YAAY,SAAZA,SAAY,CAACtE,KAAD;AAAA,SAAWyD,SAASc,eAAT,CAAyBvE,KAAzB,CAAX;AAAA,CAAlB;AACA,IAAMwE,oBAAqB,SAArBA,iBAAqB,CAACxE,KAAD;AAAA,SAAWyD,SAASgB,uBAAT,CAAiCzE,KAAjC,CAAX;AAAA,CAA3B;AACA,IAAM0E,eAAe,SAAfA,YAAe,CAAC1E,KAAD;AAAA,SAAWyD,SAASpB,kBAAT,CAA4BrC,KAA5B,CAAX;AAAA,CAArB;;AAEA,sBAAOqE,SAAP,EAAkBZ,QAAlB,EAA4B;AAC1BkB,YAAUtB,WADgB;AAE1BuB,cAAYvB;AAFc,CAA5B;;kBAKegB,S;;AACf,IAAMQ,cAAc,IAAIxB,WAAJ,EAApB;QACQwB,W,GAAAA,W;QAAaR,S,GAAAA,S;QAAWD,oB,GAAAA,oB;QAAsBE,S,GAAAA,S;QAAWE,iB,GAAAA,iB","file":"index.js","sourcesContent":["import extend from 'extend';\r\nimport {isArray} from 'util';\r\nimport {isDate} from 'util';\r\nimport {sprintf} from \"sprintf-js\";\r\nimport events from 'events';\r\nimport except from 'except';\r\nimport strftime from './strftime';\r\n\r\nconst translationScope = 'counterpart';\r\n\r\nconst isString = (val) => typeof val === 'string' || Object.prototype.toString.call(val) === '[object String]';\r\n\r\nconst isFunction = (val) => typeof val === 'function' || Object.prototype.toString.call(val) === '[object Function]';\r\n\r\nconst isPlainObject = (val) => {\r\n  //Deal with older browsers (IE8) that don't return [object Null] in this case.\r\n  if (val === null) {\r\n    return false;\r\n  }\r\n  return Object.prototype.toString.call(val) === '[object Object]';\r\n}\r\n\r\nconst isSymbol = (key) => isString(key) && key[0] === ':';\r\n\r\nconst hasOwnProp = (obj, key) => Object.prototype.hasOwnProperty.call(obj, key);\r\n\r\nconst getEntry = (translations, keys) => keys.reduce((result, key) => {\r\n                                            if (isPlainObject(result) && hasOwnProp(result, key)) {\r\n                                              return result[key];\r\n                                            } else {\r\n                                              return null;\r\n                                            }\r\n                                          }, translations);\r\n\r\nclass Counterpart {\r\n  constructor() {\r\n    this._registry = {\r\n      locale: 'en',\r\n      interpolate: true,\r\n      fallbackLocales: [],\r\n      scope: null,\r\n      translations: {},\r\n      interpolations: {},\r\n      normalizedKeys: {},\r\n      separator: '.',\r\n      keepTrailingDot: false,\r\n      keyTransformer(key) { return key; }\r\n    };\r\n\r\n    this.registerTranslationsIntern('en', require('../locales/en'));\r\n    this.setMaxListeners(0);\r\n  }\r\n\r\n  getLocale() {\r\n    return this._registry.locale;\r\n  }\r\n\r\n  setLocaleIntern(value) {\r\n    const previous = this._registry.locale;\r\n\r\n    if (previous != value) {\r\n      this._registry.locale = value;\r\n      events.EventEmitter.emit('localechange', value, previous);\r\n    }\r\n\r\n    return previous;\r\n  }\r\n\r\n  getFallbackLocale() {\r\n    return this._registry.fallbackLocales;\r\n  }\r\n\r\n  setFallbackLocaleIntern(value) {\r\n    const previous = this._registry.fallbackLocales;\r\n    this._registry.fallbackLocales = [].concat(value || []);\r\n    return previous;\r\n  }\r\n\r\n  getAvailableLocales() {\r\n    return this._registry.availableLocales || Object.keys(this._registry.translations);\r\n  }\r\n\r\n  setAvailableLocales(value) {\r\n    const previous = this.getAvailableLocales();\r\n    this._registry.availableLocales = value;\r\n    return previous;\r\n  }\r\n\r\n  getSeparator() {\r\n    return this._registry.separator;\r\n  }\r\n\r\n  setSeparatorIntern(value) {\r\n    const previous = this._registry.separator;\r\n    this._registry.separator = value;\r\n    return previous;\r\n  }\r\n\r\n  setInterpolate(value) {\r\n    const previous = this._registry.interpolate;\r\n    this._registry.interpolate = value;\r\n    return previous;\r\n  }\r\n\r\n  getInterpolate() {\r\n    return this._registry.interpolate;\r\n  }\r\n\r\n  setKeyTransformer(value) {\r\n    const previous = this._registry.keyTransformer;\r\n    this._registry.keyTransformer = value;\r\n    return previous;\r\n  }\r\n\r\n  getKeyTransformer() {\r\n    return this._registry.keyTransformer;\r\n  }\r\n\r\n  registerTranslationsIntern(locale, data) {\r\n    const translations = {};\r\n    translations[locale] = data;\r\n    extend(true, this._registry.translations, translations);\r\n    return translations;\r\n  }\r\n\r\n  registerInterpolations(data) {\r\n    return extend(true, this._registry.interpolations, data);\r\n  }\r\n\r\n  translateIntern(key, options) {\r\n    if (!isArray(key) && !isString(key) || !key.length) {\r\n      throw new Error('invalid argument: key');\r\n    }\r\n\r\n    if (isSymbol(key)) {\r\n      key = key.substr(1);\r\n    }\r\n\r\n    key = this._registry.keyTransformer(key, options);\r\n\r\n    options = extend(true, {}, options);\r\n\r\n    let locale = options.locale || this._registry.locale;\r\n    delete options.locale;\r\n\r\n    const scope = options.scope || this._registry.scope;\r\n    delete options.scope;\r\n\r\n    const separator = options.separator || this._registry.separator;\r\n    delete options.separator;\r\n\r\n    const fallbackLocales = [].concat(options.fallbackLocale || this._registry.fallbackLocales);\r\n    delete options.fallbackLocale;\r\n\r\n    const keys = this._normalizeKeys(locale, scope, key, separator);\r\n\r\n    let entry = getEntry(this._registry.translations, keys);\r\n\r\n    if (entry === null && options.fallback) {\r\n      events.EventEmitter.emit('translationnotfound', locale, key, options.fallback, scope);\r\n      entry = this._fallback(locale, scope, key, options.fallback, options);\r\n    }\r\n\r\n    if (entry === null && fallbackLocales.length > 0 && !fallbackLocales.includes(locale)) {\r\n      for (const ix in fallbackLocales) {\r\n        const fallbackLocale = fallbackLocales[ix];\r\n        const fallbackKeys = this._normalizeKeys(fallbackLocale, scope, key, separator);\r\n        entry = getEntry(this._registry.translations, fallbackKeys);\r\n\r\n        if (entry) {\r\n          locale = fallbackLocale;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    if (entry === null) {\r\n      entry = `missing translation: ${keys.join(separator)}`;\r\n    }\r\n\r\n    entry = this._pluralize(locale, entry, options.count);\r\n\r\n    if (this._registry.interpolate !== false && options.interpolate !== false) {\r\n      entry = this._interpolate(entry, options);\r\n    }\r\n\r\n    return entry;\r\n  }\r\n\r\n  localize(object, options) {\r\n    if (!isDate(object)) {\r\n      throw new Error('invalid argument: object must be a date');\r\n    }\r\n\r\n    options = extend(true, {}, options);\r\n\r\n    const locale  = options.locale  || this._registry.locale;\r\n    const scope   = options.scope   || translationScope;\r\n    const type    = options.type    || 'datetime';\r\n    let format  = options.format  || 'default';\r\n\r\n    options = { locale, scope, interpolate: false };\r\n    format  = this.translateIntern(['formats', type, format], extend(true, {}, options));\r\n\r\n    return strftime(object, format, this.translateIntern('names', options));\r\n  }\r\n\r\n  _pluralize(locale, entry, count) {\r\n    if (typeof entry !== 'object' || entry === null || typeof count !== 'number') {\r\n      return entry;\r\n    }\r\n\r\n    const pluralizeFunc = this.translateIntern('pluralize', { locale, scope: translationScope });\r\n\r\n    if (Object.prototype.toString.call(pluralizeFunc) !== '[object Function]') {\r\n      return pluralizeFunc;\r\n    }\r\n\r\n    return pluralizeFunc(entry, count);\r\n  }\r\n\r\n  withLocale(locale, callback, context) {\r\n    const previous = this._registry.locale;\r\n    this._registry.locale = locale;\r\n    const result = callback.call(context);\r\n    this._registry.locale = previous;\r\n    return result;\r\n  }\r\n\r\n  withScope(scope, callback, context) {\r\n    const previous = this._registry.scope;\r\n    this._registry.scope = scope;\r\n    const result = callback.call(context);\r\n    this._registry.scope = previous;\r\n    return result;\r\n  }\r\n\r\n  withSeparator(separator, callback, context) {\r\n    const previous = this.setSeparatorIntern(separator);\r\n    const result = callback.call(context);\r\n    this.setSeparatorIntern(previous);\r\n    return result;\r\n  }\r\n\r\n  _normalizeKeys(locale, scope, key, separator) {\r\n    let keys = [];\r\n\r\n    keys = keys.concat(this._normalizeKey(locale, separator));\r\n    keys = keys.concat(this._normalizeKey(scope, separator));\r\n    keys = keys.concat(this._normalizeKey(key, separator));\r\n\r\n    return keys;\r\n  }\r\n\r\n  _normalizeKey(key, separator) {\r\n    this._registry.normalizedKeys[separator] = this._registry.normalizedKeys[separator] || {};\r\n\r\n    this._registry.normalizedKeys[separator][key] = this._registry.normalizedKeys[separator][key] || ((key => {\r\n      if (isArray(key)) {\r\n        const normalizedKeyArray = key.map(k => this._normalizeKey(k, separator));\r\n\r\n        return [].concat(...normalizedKeyArray);\r\n      } else {\r\n        if (typeof key === 'undefined' || key === null) {\r\n          return [];\r\n        }\r\n\r\n        const keys = key.split(separator);\r\n\r\n        for (let i = keys.length - 1; i >= 0; i--) {\r\n          if (keys[i] === '') {\r\n            keys.splice(i, 1);\r\n\r\n            if (this._registry.keepTrailingDot === true && i == keys.length) {\r\n              keys[keys.length - 1] += `${separator}`;\r\n            }\r\n          }\r\n        }\r\n\r\n        return keys;\r\n      }\r\n    }))(key);\r\n\r\n    return this._registry.normalizedKeys[separator][key];\r\n  }\r\n\r\n  _interpolate(entry, values) {\r\n    if (typeof entry !== 'string') {\r\n      return entry;\r\n    }\r\n\r\n    return sprintf(entry, extend({}, this._registry.interpolations, values));\r\n  }\r\n\r\n  _resolve(locale, scope, object, subject, options={}) {\r\n    if (options.resolve === false) {\r\n      return subject;\r\n    }\r\n\r\n    let result;\r\n\r\n    if (isSymbol(subject)) {\r\n      result = this.translateIntern(subject, extend({}, options, { locale, scope }));\r\n    } else if (isFunction(subject)) {\r\n      let dateOrTime;\r\n\r\n      if (options.object) {\r\n        dateOrTime = options.object;\r\n        delete options.object;\r\n      } else {\r\n        dateOrTime = object;\r\n      }\r\n\r\n      result = this._resolve(locale, scope, object, subject(dateOrTime, options));\r\n    } else {\r\n      result = subject;\r\n    }\r\n\r\n    return /^missing translation:/.test(result) ? null : result;\r\n  }\r\n\r\n  _fallback(locale, scope, object, subject, options) {\r\n    options = except(options, 'fallback');\r\n\r\n    if (isArray(subject)) {\r\n      for (let i = 0, ii = subject.length; i < ii; i++) {\r\n        const result = this._resolve(locale, scope, object, subject[i], options);\r\n\r\n        if (result) {\r\n          return result;\r\n        }\r\n      }\r\n\r\n      return null;\r\n    } else {\r\n      return this._resolve(locale, scope, object, subject, options);\r\n    }\r\n  }\r\n}\r\n\r\nconst instance = new Counterpart();\r\n\r\nCounterpart.prototype.onLocaleChange =\r\nCounterpart.prototype.addLocaleChangeListener = (callback) => {\r\n                                                  events.EventEmitter.addListener('localechange', callback);\r\n                                                };\r\n\r\nCounterpart.prototype.offLocaleChange =\r\nCounterpart.prototype.removeLocaleChangeListener = (callback) => {\r\n                                                      events.EventEmitter.removeListener('localechange', callback);\r\n                                                    };\r\n\r\nCounterpart.prototype.onTranslationNotFound =\r\nCounterpart.prototype.addTranslationNotFoundListener = (callback) => {\r\n                                                          events.EventEmitter.addListener('translationnotfound', callback);\r\n                                                        };\r\n\r\nCounterpart.prototype.offTranslationNotFound =\r\nCounterpart.prototype.removeTranslationNotFoundListener = (callback) => {\r\n                                                            events.EventEmitter.removeListener('translationnotfound', callback);\r\n                                                          };\r\nconst registerTranslations = (locale, data) => instance.registerTranslationsIntern(locale, data);\r\nconst translate = (key, options) => instance.translateIntern(key, options);\r\nconst setLocale = (value) => instance.setLocaleIntern(value);\r\nconst setFallbackLocale  = (value) => instance.setFallbackLocaleIntern(value);\r\nconst setSeparator = (value) => instance.setSeparatorIntern(value);\r\n\r\nextend(translate, instance, {\r\n  Instance: Counterpart,\r\n  Translator: Counterpart\r\n});\r\n\r\nexport default translate\r\nconst counterpart = new Counterpart;\r\nexport {counterpart, translate, registerTranslations, setLocale, setFallbackLocale}\r\n"]}